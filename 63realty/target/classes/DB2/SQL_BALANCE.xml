<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="balance">
	<resultMap id="BalanceVO" type="kr.co.realty.data.balance.vo.BalanceVO">	
		<result property ="blYear"			column="BL_YEAR"/>
		<result property ="blTitle"			column="BL_TITLE"/>
		<result property ="a1c1"			column="A1C1"/>
		<result property ="a1c2"			column="A1C2"/>
		<result property ="a1c3"			column="A1C3"/>
		<result property ="a1c4"			column="A1C4"/>
		<result property ="a1c5"			column="A1C5"/>
		<result property ="a1c6"			column="A1C6"/>
		<result property ="a1c7"			column="A1C7"/>
		<result property ="a1m0"			column="A1M0"/>
		<result property ="a1m1"			column="A1M1"/>
		<result property ="a1m2"			column="A1M2"/>
		<result property ="a1m3"			column="A1M3"/>
		<result property ="a1m4"			column="A1M4"/>
		<result property ="a1m5"			column="A1M5"/>
		<result property ="a1m6"			column="A1M6"/>
		<result property ="a1m7"			column="A1M7"/>
		<result property ="a2c1"			column="A2C1"/>
		<result property ="a2c2"			column="A2C2"/>
		<result property ="a2c3"			column="A2C3"/>
		<result property ="a2c4"			column="A2C4"/>
		<result property ="a2c5"			column="A2C5"/>
		<result property ="a2c6"			column="A2C6"/>
		<result property ="a2c7"			column="A2C7"/>
		<result property ="a2c8"			column="A2C8"/>
		<result property ="a2c9"			column="A2C9"/>
		<result property ="a2m0"			column="A2M0"/>
		<result property ="a2m1"			column="A2M1"/>
		<result property ="a2m2"			column="A2M2"/>
		<result property ="a2m3"			column="A2M3"/>
		<result property ="a2m4"			column="A2M4"/>
		<result property ="a2m5"			column="A2M5"/>
		<result property ="a2m6"			column="A2M6"/>
		<result property ="a2m7"			column="A2M7"/>
		<result property ="a2m8"			column="A2M8"/>
		<result property ="a2m9"			column="A2M9"/>
		<result property ="assTot"			column="ASS_TOT"/>
		<result property ="l1c1"			column="L1C1"/>
		<result property ="l1c2"			column="L1C2"/>
		<result property ="l1c3"			column="L1C3"/>
		<result property ="l1c4"			column="L1C4"/>
		<result property ="l1c5"			column="L1C5"/>
		<result property ="l1m0"			column="L1M0"/>
		<result property ="l1m1"			column="L1M1"/>
		<result property ="l1m2"			column="L1M2"/>
		<result property ="l1m3"			column="L1M3"/>
		<result property ="l1m4"			column="L1M4"/>
		<result property ="l1m5"			column="L1M5"/>
		<result property ="l2c1"			column="L2C1"/>
		<result property ="l2c2"			column="L2C2"/>
		<result property ="l2c3"			column="L2C3"/>
		<result property ="l2c4"			column="L2C4"/>
		<result property ="l2m0"			column="L2M0"/>
		<result property ="l2m1"			column="L2M1"/>
		<result property ="l2m2"			column="L2M2"/>
		<result property ="l2m3"			column="L2M3"/>
		<result property ="l2m4"			column="L2M4"/>
		<result property ="liaTot"			column="LIA_TOT"/>
		<result property ="c1c1"			column="C1C1"/>
		<result property ="c1m0"			column="C1M0"/>
		<result property ="c1m1"			column="C1M1"/>
		<result property ="c1m2"			column="C1M2"/>
		<result property ="c1m3"			column="C1M3"/>
		<result property ="capTot"			column="CAP_TOT"/>
		<result property ="capLiaTot"			column="CAP_LIA_TOT"/>
		<result property ="commentDate"	column="COMMENT_DATE"/>
		<result property ="blDesc"				column="BL_DESC"/>
		<result property ="regDate"			column="REG_DATE"/>
		<result property ="regID"				column="REG_ID"/>
		<result property ="regName"			column="REG_NAME"/>
	</resultMap>


	<select id="selectCountListForBalance"  parameterType="SearchVO" resultType="integer">	
		SELECT
			COUNT(BL_YEAR)			
		FROM HPCDTA.BALANCING_ACCOUNTS 
		WHERE 1=1		
		<if test="userFlag == 'USER'">
			AND IS_USE = 'Y'
		</if>
		<if test="searchText != null and searchText != ''">			
			<if test="searchType == 's_title'">
				AND (BL_TITLE LIKE '%'||TRIM(CAST ((#{searchText}) AS VARCHAR(100) CCSID 1208))||'%')
			</if>
		</if>
	</select>
	
	<select id="selectCountOneForBalance"  parameterType="SearchVO" resultType="integer">	
		SELECT
			COUNT(BL_YEAR)			
		FROM HPCDTA.BALANCING_ACCOUNTS 
		WHERE BL_YEAR = #{blYear,jdbcType=INTEGER}
	</select>
	
	<select id="selectListForBalance"  parameterType="SearchVO" resultMap="BalanceVO">
	SELECT * FROM (	
		SELECT
			T1.BL_YEAR
	        ,T1.BL_TITLE
	        ,T1.REG_DATE
	        ,T1.REG_ID
	        ,T2.ADM_NAME as REG_NAME
			,ROW_NUMBER() OVER( ORDER BY T1.BL_YEAR DESC) AS RNUM
		FROM HPCDTA.BALANCING_ACCOUNTS T1
			LEFT OUTER JOIN HPCDTA.ADM_MEMBER T2
			ON T1.REG_ID = T2.ADM_ID
		WHERE 1=1
		<if test="userFlag == 'USER'">
			AND IS_USE = 'Y'
		</if>
		<if test="searchText != null and searchText != ''">			
			<if test="searchType == 's_title'">
				AND (BL_TITLE LIKE '%'||TRIM(CAST ((#{searchText}) AS VARCHAR(100) CCSID 1208))||'%')
			</if>
		</if>	
		)T WHERE 
				RNUM BETWEEN ((#{pageIndex}-1) * #{pageCount}) + 1 AND ((#{pageIndex}-1) * #{pageCount}) + #{pageCount}
	</select>
	
	<select id="selectOneForBalance"  parameterType="BalanceVO" resultMap="BalanceVO">
		SELECT
			T1.BL_YEAR
			,T1.BL_TITLE
			,T1.A1C1
			,T1.A1C2
			,T1.A1C3
			,T1.A1C4
			,T1.A1C5
			,T1.A1C6
			,T1.A1C7
			,T1.A1M0
			,T1.A1M1
			,T1.A1M2
			,T1.A1M3
			,T1.A1M4
			,T1.A1M5
			,T1.A1M6
			,T1.A1M7
			,T1.A2C1
			,T1.A2C2
			,T1.A2C3
			,T1.A2C4
			,T1.A2C5
			,T1.A2C6
			,T1.A2C7
			,T1.A2C8
			,T1.A2C9
			,T1.A2M0
			,T1.A2M1
			,T1.A2M2
			,T1.A2M3
			,T1.A2M4
			,T1.A2M5
			,T1.A2M6
			,T1.A2M7
			,T1.A2M8
			,T1.A2M9
			,T1.ASS_TOT
			,T1.L1C1
			,T1.L1C2
			,T1.L1C3
			,T1.L1C4
			,T1.L1C5
			,T1.L1M0
			,T1.L1M1
			,T1.L1M2
			,T1.L1M3
			,T1.L1M4
			,T1.L1M5
			,T1.L2C1
			,T1.L2C2
			,T1.L2C3
			,T1.L2C4
			,T1.L2M0
			,T1.L2M1
			,T1.L2M2
			,T1.L2M3
			,T1.L2M4
			,T1.LIA_TOT
			,T1.C1C1
			,T1.C1M0
			,T1.C1M1
			,T1.C1M2
			,T1.C1M3
			,T1.CAP_TOT
			,T1.CAP_LIA_TOT
			,T1.COMMENT_DATE
			,T1.BL_DESC
			,T1.REG_DATE
			,T1.REG_ID
		FROM HPCDTA.BALANCING_ACCOUNTS T1			
		WHERE BL_YEAR=#{blYear}	
	</select>
	
	<insert id="insertBalance" parameterType="BalanceVO">
          INSERT INTO 
          	HPCDTA.BALANCING_ACCOUNTS ( 
				BL_YEAR
				, BL_TITLE
				, A1C1
				, A1C2
				, A1C3
				, A1C4
				, A1C5
				, A1C6
				, A1C7
				, A1M0
				, A1M1
				, A1M2
				, A1M3
				, A1M4
				, A1M5
				, A1M6
				, A1M7
				, A2C1
				, A2C2
				, A2C3
				, A2C4
				, A2C5
				, A2C6
				, A2C7
				, A2C8
				, A2C9
				, A2M0
				, A2M1
				, A2M2
				, A2M3
				, A2M4
				, A2M5
				, A2M6
				, A2M7
				, A2M8
				, A2M9
				, ASS_TOT
				, L1C1
				, L1C2
				, L1C3
				, L1C4
				, L1C5
				, L1M0
				, L1M1
				, L1M2
				, L1M3
				, L1M4
				, L1M5
				, L2C1
				, L2C2
				, L2C3
				, L2C4
				, L2M0
				, L2M1
				, L2M2
				, L2M3
				, L2M4
				, LIA_TOT
				, C1C1
				, C1M0
				, C1M1
				, C1M2
				, C1M3
				, CAP_TOT
				, CAP_LIA_TOT
				, COMMENT_DATE
				, BL_DESC
				, REG_DATE
				, REG_ID
          ) VALUES ( 
				#{blYear,jdbcType=INTEGER}
				, #{blTitle,jdbcType=VARCHAR}
				, #{a1c1,jdbcType=VARCHAR}
				, #{a1c2,jdbcType=VARCHAR}
				, #{a1c3,jdbcType=VARCHAR}
				, #{a1c4,jdbcType=VARCHAR}
				, #{a1c5,jdbcType=VARCHAR}
				, #{a1c6,jdbcType=VARCHAR}
				, #{a1c7,jdbcType=VARCHAR}
				, #{a1m0,jdbcType=VARCHAR}
				, #{a1m1,jdbcType=VARCHAR}
				, #{a1m2,jdbcType=VARCHAR}
				, #{a1m3,jdbcType=VARCHAR}
				, #{a1m4,jdbcType=VARCHAR}
				, #{a1m5,jdbcType=VARCHAR}
				, #{a1m6,jdbcType=VARCHAR}
				, #{a1m7,jdbcType=VARCHAR}
				, #{a2c1,jdbcType=VARCHAR}
				, #{a2c2,jdbcType=VARCHAR}
				, #{a2c3,jdbcType=VARCHAR}
				, #{a2c4,jdbcType=VARCHAR}
				, #{a2c5,jdbcType=VARCHAR}
				, #{a2c6,jdbcType=VARCHAR}
				, #{a2c7,jdbcType=VARCHAR}
				, #{a2c8,jdbcType=VARCHAR}
				, #{a2c9,jdbcType=VARCHAR}
				, #{a2m0,jdbcType=VARCHAR}
				, #{a2m1,jdbcType=VARCHAR}
				, #{a2m2,jdbcType=VARCHAR}
				, #{a2m3,jdbcType=VARCHAR}
				, #{a2m4,jdbcType=VARCHAR}
				, #{a2m5,jdbcType=VARCHAR}
				, #{a2m6,jdbcType=VARCHAR}
				, #{a2m7,jdbcType=VARCHAR}
				, #{a2m8,jdbcType=VARCHAR}
				, #{a2m9,jdbcType=VARCHAR}
				, #{assTot,jdbcType=VARCHAR}
				, #{l1c1,jdbcType=VARCHAR}
				, #{l1c2,jdbcType=VARCHAR}
				, #{l1c3,jdbcType=VARCHAR}
				, #{l1c4,jdbcType=VARCHAR}
				, #{l1c5,jdbcType=VARCHAR}
				, #{l1m0,jdbcType=VARCHAR}
				, #{l1m1,jdbcType=VARCHAR}
				, #{l1m2,jdbcType=VARCHAR}
				, #{l1m3,jdbcType=VARCHAR}
				, #{l1m4,jdbcType=VARCHAR}
				, #{l1m5,jdbcType=VARCHAR}
				, #{l2c1,jdbcType=VARCHAR}
				, #{l2c2,jdbcType=VARCHAR}
				, #{l2c3,jdbcType=VARCHAR}
				, #{l2c4,jdbcType=VARCHAR}
				, #{l2m0,jdbcType=VARCHAR}
				, #{l2m1,jdbcType=VARCHAR}
				, #{l2m2,jdbcType=VARCHAR}
				, #{l2m3,jdbcType=VARCHAR}
				, #{l2m4,jdbcType=VARCHAR}
				, #{liaTot,jdbcType=VARCHAR}
				, #{c1c1,jdbcType=VARCHAR}
				, #{c1m0,jdbcType=VARCHAR}
				, #{c1m1,jdbcType=VARCHAR}
				, #{c1m2,jdbcType=VARCHAR}
				, #{c1m3,jdbcType=VARCHAR}
				, #{capTot,jdbcType=VARCHAR}
				, #{capLiaTot,jdbcType=VARCHAR}
				, #{commentDate,jdbcType=VARCHAR}
				, #{blDesc,jdbcType=VARCHAR}
				, CURRENT TIMESTAMP
				, #{regID,jdbcType=VARCHAR}
          )
    </insert>
    
    <update id="updateBalance" parameterType="BalanceVO">
	UPDATE HPCDTA.BALANCING_ACCOUNTS SET
		 BL_TITLE=#{blTitle,jdbcType=VARCHAR}
		, A1C1=#{a1c1,jdbcType=VARCHAR}
		, A1C2=#{a1c2,jdbcType=VARCHAR}
		, A1C3=#{a1c3,jdbcType=VARCHAR}
		, A1C4=#{a1c4,jdbcType=VARCHAR}
		, A1C5=#{a1c5,jdbcType=VARCHAR}
		, A1C6=#{a1c6,jdbcType=VARCHAR}
		, A1C7=#{a1c7,jdbcType=VARCHAR}
		, A1M0=#{a1m0,jdbcType=VARCHAR}
		, A1M1=#{a1m1,jdbcType=VARCHAR}
		, A1M2=#{a1m2,jdbcType=VARCHAR}
		, A1M3=#{a1m3,jdbcType=VARCHAR}
		, A1M4=#{a1m4,jdbcType=VARCHAR}
		, A1M5=#{a1m5,jdbcType=VARCHAR}
		, A1M6=#{a1m6,jdbcType=VARCHAR}
		, A1M7=#{a1m7,jdbcType=VARCHAR}
		, A2C1=#{a2c1,jdbcType=VARCHAR}
		, A2C2=#{a2c2,jdbcType=VARCHAR}
		, A2C3=#{a2c3,jdbcType=VARCHAR}
		, A2C4=#{a2c4,jdbcType=VARCHAR}
		, A2C5=#{a2c5,jdbcType=VARCHAR}
		, A2C6=#{a2c6,jdbcType=VARCHAR}
		, A2C7=#{a2c7,jdbcType=VARCHAR}
		, A2C8=#{a2c8,jdbcType=VARCHAR}
		, A2C9=#{a2c9,jdbcType=VARCHAR}
		, A2M0=#{a2m0,jdbcType=VARCHAR}
		, A2M1=#{a2m1,jdbcType=VARCHAR}
		, A2M2=#{a2m2,jdbcType=VARCHAR}
		, A2M3=#{a2m3,jdbcType=VARCHAR}
		, A2M4=#{a2m4,jdbcType=VARCHAR}
		, A2M5=#{a2m5,jdbcType=VARCHAR}
		, A2M6=#{a2m6,jdbcType=VARCHAR}
		, A2M7=#{a2m7,jdbcType=VARCHAR}
		, A2M8=#{a2m8,jdbcType=VARCHAR}
		, A2M9=#{a2m9,jdbcType=VARCHAR}
		, ASS_TOT=#{assTot,jdbcType=VARCHAR}
		, L1C1=#{l1c1,jdbcType=VARCHAR}
		, L1C2=#{l1c2,jdbcType=VARCHAR}
		, L1C3=#{l1c3,jdbcType=VARCHAR}
		, L1C4=#{l1c4,jdbcType=VARCHAR}
		, L1C5=#{l1c5,jdbcType=VARCHAR}
		, L1M0=#{l1m0,jdbcType=VARCHAR}
		, L1M1=#{l1m1,jdbcType=VARCHAR}
		, L1M2=#{l1m2,jdbcType=VARCHAR}
		, L1M3=#{l1m3,jdbcType=VARCHAR}
		, L1M4=#{l1m4,jdbcType=VARCHAR}
		, L1M5=#{l1m5,jdbcType=VARCHAR}
		, L2C1=#{l2c1,jdbcType=VARCHAR}
		, L2C2=#{l2c2,jdbcType=VARCHAR}
		, L2C3=#{l2c3,jdbcType=VARCHAR}
		, L2C4=#{l2c4,jdbcType=VARCHAR}
		, L2M0=#{l2m0,jdbcType=VARCHAR}
		, L2M1=#{l2m1,jdbcType=VARCHAR}
		, L2M2=#{l2m2,jdbcType=VARCHAR}
		, L2M3=#{l2m3,jdbcType=VARCHAR}
		, L2M4=#{l2m4,jdbcType=VARCHAR}
		, LIA_TOT=#{liaTot,jdbcType=VARCHAR}
		, C1C1=#{c1c1,jdbcType=VARCHAR}
		, C1M0=#{c1m0,jdbcType=VARCHAR}
		, C1M1=#{c1m1,jdbcType=VARCHAR}
		, C1M2=#{c1m2,jdbcType=VARCHAR}
		, C1M3=#{c1m3,jdbcType=VARCHAR}
		, CAP_TOT=#{capTot,jdbcType=VARCHAR}
		, CAP_LIA_TOT=#{capLiaTot,jdbcType=VARCHAR}
		, COMMENT_DATE=#{commentDate,jdbcType=VARCHAR}
		, BL_DESC=#{blDesc,jdbcType=VARCHAR}
	WHERE BL_YEAR=#{blYear,jdbcType=INTEGER}
    </update>
    
    <delete id="deleteBalance" parameterType="BalanceVO">
		DELETE FROM HPCDTA.BALANCING_ACCOUNTS WHERE BL_YEAR=#{blYear,jdbcType=INTEGER}
    </delete>
    
        <select id="selectListForYearBalance" resultMap="BalanceVO">
		SELECT
			BL_YEAR
		FROM HPCDTA.BALANCING_ACCOUNTS		
		GROUP BY BL_YEAR
		ORDER BY BL_YEAR DESC		
	</select>
    
</mapper>