<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="menu">
	<resultMap id="AdminVO" type="kr.co.realty.data.admin.vo.AdminVO">
		<result property = "admSeq"                    column="ADM_SEQ" />
		<result property = "admID"	                  column="ADM_ID" />
		<result property = "admPW"                     column="ADM_PW" />
		<result property = "admName"                 column="ADM_NAME" />
		<result property = "email"                       column="EMAIL" />
		<result property = "departmentName"       column="DEPARTMENT_NAME" />
		<result property = "telnum"                     column="TELNUM" />
		<result property = "mobilenum"                column="MOBILENUM" />
		<result property = "isUse"                      column="IS_USE" />
		<result property = "regDate"                    column="REG_DATE" />
	</resultMap>
	
	<resultMap id="MenuVO" type="kr.co.realty.data.menu.vo.MenuVO">
		<result property = "menuSeq"        		column="MENU_SEQ" />
		<result property = "menuName"     		column="MENU_NAME" />
		<result property = "pMenuSeq"      		column="P_MENU_SEQ" />
		<result property = "rootSeq"          		column="ROOT_SEQ" />
		<result property = "ord"                  		column="ORD" />
		<result property = "menuUrl"          		column="MENU_URL" />
		<result property = "isUse"              		column="IS_USE" />
		<result property = "level"                 		column="LEVEL" />
		<result property = "depthFullname"       column="DEPTH_FULLNAME" />
		<result property = "isLeaf"      		 		column="IS_LEAF" />
		<result property = "authChk"      		 	column="AUTH_CHK" />
	</resultMap>
	
	
	
	<select id="selectListForAuthMenu"  parameterType="AdminVO" resultMap="MenuVO">	
		SELECT 
			LEVEL
			,MENU_SEQ
			,MENU_NAME
			,CONNECT_BY_ROOT MENU_NAME||' &gt; '||MENU_NAME AS DEPTH_FULLNAME
			,CONNECT_BY_ISLEAF AS IS_LEAF,MENU_URL
			,CONNECT_BY_ROOT MENU_SEQ as ROOT_SEQ
	       FROM  (SELECT a.* FROM HPCDTA.ADM_MENU a INNER JOIN HPCDTA.ADM_AUTH b ON a.MENU_SEQ=b.MENU_SEQ and b.ADM_ID=#{admID} WHERE a.IS_USE='Y')t
	       START WITH P_MENU_SEQ = 0   
	       CONNECT BY PRIOR  MENU_SEQ = P_MENU_SEQ
	       ORDER SIBLINGS BY ORD	
	</select>
	
	<select id="selectListForMenu"  resultMap="MenuVO">	
		SELECT 
			LEVEL
			,MENU_SEQ
			,MENU_NAME
			,CONNECT_BY_ROOT MENU_NAME||' &gt; '||MENU_NAME AS DEPTH_FULLNAME
			,CONNECT_BY_ISLEAF AS IS_LEAF,MENU_URL
			,CONNECT_BY_ROOT MENU_SEQ as ROOT_SEQ
	       FROM  (SELECT * FROM HPCDTA.ADM_MENU WHERE IS_USE='Y')t
	       START WITH P_MENU_SEQ = 0   
	       CONNECT BY PRIOR  MENU_SEQ = P_MENU_SEQ
	       ORDER SIBLINGS BY ORD	
	</select>
	
	<select id="selectListForAuthMenuEdit"  parameterType="AdminVO" resultMap="MenuVO">	
		SELECT
			LEVEL
			,MENU_SEQ
			,MENU_NAME
			,CONNECT_BY_ROOT MENU_NAME||' &gt; '||MENU_NAME AS DEPTH_FULLNAME
			,CONNECT_BY_ISLEAF AS IS_LEAF,MENU_URL
			,CONNECT_BY_ROOT MENU_SEQ as ROOT_SEQ
			,AUTH_CHK
	       FROM  (SELECT a.*, CASE WHEN b.ADM_ID IS NULL THEN 'N' ELSE 'Y' END AS AUTH_CHK FROM HPCDTA.ADM_MENU a LEFT OUTER JOIN HPCDTA.ADM_AUTH b on a.MENU_SEQ=b.MENU_SEQ and b.ADM_ID=#{admID} WHERE IS_USE='Y')t
	       START WITH P_MENU_SEQ = 0   
	       CONNECT BY PRIOR  MENU_SEQ = P_MENU_SEQ
	       ORDER SIBLINGS BY ORD	
	</select>
	
</mapper>